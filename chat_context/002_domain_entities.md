# Flaffy — Domain Entities & Relationships

## 1. Назначение документа

Этот файл описывает **предметную область Flaffy**: ключевые сущности, их смысл, границы ответственности и связи между ними.

Документ нужен для:

* выравнивания понимания между людьми и AI-ассистентами
* проектирования архитектуры и БД
* корректной интерпретации данных и рисков

Важно: описание **концептуальное**, не привязано к конкретной реализации или схеме БД.

---

## 2. Принципы моделирования сущностей

При описании сущностей Flaffy придерживается следующих принципов:

* **Факт важнее интерпретации** — сущности хранят факты, выводы делаются поверх
* **Связи первичны** — ценность не в отдельных объектах, а в их пересечениях
* **Допускается неполнота** — отсутствие данных тоже сигнал
* **Один объект = несколько ролей** (например, физлицо может быть и продавцом, и ответчиком)

---

## 3. Объект недвижимости (Property)

### Описание

Физический объект недвижимости, являющийся центральной точкой большинства проверок.

### Примеры

* квартира
* жилой дом
* апартаменты
* объект в составе ЖК

### Ключевые атрибуты (концептуально)

* адрес (нормализованный)
* тип объекта
* кадастровый номер (если есть)
* связь с ЖК / домом

### Связи

* может быть связан с **застройщиком**
* фигурирует в **объявлениях**
* может упоминаться в **судебных делах**
* проверяется в рамках **отчётов**

---

## 4. Застройщик (Developer)

### Описание

Юридическое лицо, ответственное за строительство объекта или ЖК.

### Ключевые атрибуты

* наименование
* ИНН / ОГРН (если доступны)
* алиасы и варианты написаний

### Связи

* связан с одним или несколькими **объектами недвижимости**
* участвует в **судебных делах**
* фигурирует в **жалобах / отзывах**
* анализируется в **RiskCard**

Важно: застройщик — один из ключевых источников системных рисков.

---

## 5. Физическое лицо (Person)

### Описание

Частное лицо, связанное с объектом недвижимости.

### Возможные роли

* продавец
* собственник
* истец / ответчик
* участник исполнительного производства

### Ключевые атрибуты

* ФИО
* алиасы / варианты написаний
* косвенные идентификаторы (регион, совпадения адресов)

### Связи

* связан с **объектами недвижимости**
* участвует в **судебных делах**
* может иметь **исполнительные производства**

Важно: совпадение ФИО ≠ тождество личности — это всегда вероятность.

---

## 6. Судебное дело (Court Case)

### Описание

Любое судебное разбирательство, связанное с объектом, застройщиком или физлицом.

### Типы

* гражданские дела
* арбитражные дела
* административные дела

### Ключевые атрибуты

* номер дела
* суд
* стороны
* предмет спора
* статус

### Связи

* может быть связано с **объектом недвижимости**
* может быть связано с **застройщиком**
* может быть связано с **физлицом**

Судебное дело — это **факт**, а не доказательство нарушения.

---

## 7. Исполнительное производство (Enforcement Case)

### Описание

Производство ФССП, связанное с физлицом или юрлицом.

### Ключевые атрибуты

* номер производства
* сумма
* статус

### Связи

* связано с **физлицом** или **застройщиком**
* учитывается при расчёте рисков

---

## 8. Объявление (Listing)

### Описание

Публичное объявление о продаже или аренде объекта недвижимости.

### Источники

* ЦИАН
* Авито
* аналоги

### Ключевые атрибуты

* площадка
* цена
* дата публикации
* текст объявления

### Связи

* связано с **объектом недвижимости**
* может косвенно указывать на **продавца**

Объявления используются как вспомогательный, но важный сигнал.

---

## 9. Жалоба / отзыв (Complaint / Review)

### Описание

Публичные негативные или позитивные сигналы, связанные с объектом или застройщиком.

### Источники

* сайты отзывов
* форумы
* открытые площадки

### Связи

* связаны с **застройщиком** или **объектом**

Отзывы не являются доказательством, но влияют на perception risk.

---

## 10. Отчёт (Report / RiskCard)

### Описание

Результат аналитической работы Flaffy по конкретному объекту или субъекту.

### Типы

* RiskCard (UI)
* PDF-отчёт

### Содержимое

* агрегированный риск
* категории рисков
* факты и источники
* confidence

### Связи

* всегда привязан к **пользователю**
* основан на множестве других сущностей

---

## 11. Пользователь (User)

### Описание

Пользователь сервиса Flaffy.

### Типы

* физлицо
* инвестор
* риелтор
* B2B-клиент

### Связи

* инициирует создание **отчётов**
* получает доступ к результатам

---

## 12. Связи и вероятностная природа данных

Большинство связей в Flaffy:

* вероятностные
* основаны на совпадениях и эвристиках
* имеют уровень уверенности

Это критично для корректной интерпретации результата.

---

## 13. Как AI должен работать с сущностями

AI-ассистент:

* не отождествляет сущности без подтверждений
* подчёркивает вероятностный характер связей
* объясняет, *почему* сущности связаны
* избегает категоричных формулировок

---

## 14. Расширяемость модели

Модель сущностей допускает расширение:

* новые типы источников
* новые роли для сущностей
* дополнительные сигналы риска

Новые сущности описываются отдельными файлами и добавляются в этот документ при стабилизации.

---

## 15. Роль документа в chat_context

Этот файл — **семантический фундамент** проекта.

Если возникает вопрос:

> «Что это за объект и как с ним работать?»

Ответ должен быть найден здесь.
